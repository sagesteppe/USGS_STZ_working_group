geom_text(aes(x = 23, y = -3, label='drier')) +
geom_text(aes(x = 78, y = -3, label='wetter')) +
# backdrop ellipses for the text boxes.
geom_sf(data = wet_lab_bg, fill = '#124E78', alpha = 0.4, color = '#124E78', lwd = 1.1) +
geom_sf(data = int_lab_bg, fill = '#B5C2B7', alpha = 0.4, color = '#B5C2B7', lwd = 1.1) +
geom_sf(data = dri_lab_bg, fill = '#A40E4C', alpha = 0.4, color = '#A40E4C', lwd = 1.1) +
# text boxes explaining the groups
geom_text(aes(x = 10, y = 80, label = Wettest_label), size = 3) +
geom_text(aes(x = 90, y = 70, label = Intermediate_label), size = 3) +
geom_text(aes(x = 10.25, y = 60, label = Driest_label), size = 3) +
labs(
title = 'Possible effects of climatic decoupling on STZ delineation',
caption = 'Each ellipsoid represents clusters of morphotypes, an STZ group, from a canonical\n correspondence analysis of traits measured in a common garden(s).') +
theme_void() +
xlim(-10, 110) +
theme(
legend.position = 'bottom',
legend.box = "vertical",
plot.title = element_text(hjust = 0.5),
plot.caption = element_text(hjust = 0.5)
) +
guides(
shape = guide_legend(title = "Population:", nrow = 1, order = 1),
color = guide_legend(nrow = 1)
)
bord <- st_buffer(triangle, -0.1) |>
sf::st_cast('MULTILINESTRING')
ggplot() +
# first draw the raster background, everything else will be superimposed on top
# of it
geom_raster(data = int_bg, aes(x = x, y = y, fill = ID)) +
scale_fill_distiller(palette = "RdBu", guide = "none", direction = 1) +
new_scale_fill() +
# and add this to remove the values from going straight up against the borders
geom_sf(data = bord, color = '#FFFFF0')+
# now we add the grid lines across it, in the style of a USDA soil triangle
geom_sf(data = lines, color = '#FFFFF0') +
# we add the border on top of the gridlines, because the edges are confluent
# with our border and will draw over it, and that looks bad
geom_sf(data = borders, aes(color = ID), lwd = 2) +
scale_color_distiller(palette = "RdBu", guide = "none") +
new_scale_color() +
############ finally we start to add data to the plot.  ##################
# these are the core CCA areas, without the influence of a decoupled population
geom_sf(data = core, aes(color = Group, fill = Group), lwd = 1.1, alpha = 0.3) +
# add the areas where the climate is decoupled within a morphotype
# based seed zone
geom_sf(data = decoupled, aes(color = Group), lwd = 1.1, fill = NA, lty = 1) +
# these are the points representing morphos from a CCA
geom_sf(data = morphos, aes(shape = Status, fill = Group), size = 3) +
scale_shape_manual(values = shapes, name = "Population:")  +
scale_fill_manual(
values = values,
labels = labs,
name = 'STZ Group'
) +
scale_color_manual(
values = values,
labels = labs,
name = 'STZ Group'
) +
# labels for easy orientation
geom_label(aes(x = 20, y = 45, label='Temperature'), size = 5, angle = 60, fill = '#FFFFF0') +
geom_text(aes(x = 8, y = 20, label='warmer'), angle = 60) +
geom_text(aes(x = 36, y = 68, label='cooler'), angle = 60) +
geom_label(aes(x = 80, y = 45, label='Precipitation'),  size = 5, angle = 300, fill = '#FFFFF0') +
geom_text(aes(x = 64, y = 68, label='more'), angle = 300) +
geom_text(aes(x = 92, y = 20, label='less'), angle = 300) +
geom_label(aes(x = 50, y = -5, label='Geomorphology'), size = 5, fill = '#FFFFF0') +
geom_text(aes(x = 23, y = -3, label='drier')) +
geom_text(aes(x = 78, y = -3, label='wetter')) +
# backdrop ellipses for the text boxes.
geom_sf(data = wet_lab_bg, fill = '#124E78', alpha = 0.4, color = '#124E78', lwd = 1.1) +
geom_sf(data = int_lab_bg, fill = '#B5C2B7', alpha = 0.4, color = '#B5C2B7', lwd = 1.1) +
geom_sf(data = dri_lab_bg, fill = '#A40E4C', alpha = 0.4, color = '#A40E4C', lwd = 1.1) +
# text boxes explaining the groups
geom_text(aes(x = 10, y = 80, label = Wettest_label), size = 3) +
geom_text(aes(x = 90, y = 70, label = Intermediate_label), size = 3) +
geom_text(aes(x = 10.25, y = 60, label = Driest_label), size = 3) +
labs(
title = 'Possible effects of climatic decoupling on STZ delineation',
caption = 'Each ellipsoid represents clusters of morphotypes, an STZ group, from a canonical\n correspondence analysis of traits measured in a common garden(s).') +
theme_void() +
xlim(-10, 110) +
theme(
legend.position = 'bottom',
legend.box = "vertical",
plot.title = element_text(hjust = 0.5),
plot.caption = element_text(hjust = 0.5)
) +
guides(
shape = guide_legend(title = "Population:", nrow = 1, order = 1),
color = guide_legend(nrow = 1)
)
bord <- st_buffer(triangle, -0.5) |>
sf::st_cast('MULTILINESTRING')
ggplot() +
# first draw the raster background, everything else will be superimposed on top
# of it
geom_raster(data = int_bg, aes(x = x, y = y, fill = ID)) +
scale_fill_distiller(palette = "RdBu", guide = "none", direction = 1) +
new_scale_fill() +
# and add this to remove the values from going straight up against the borders
geom_sf(data = bord, color = '#FFFFF0')+
# now we add the grid lines across it, in the style of a USDA soil triangle
geom_sf(data = lines, color = '#FFFFF0') +
# we add the border on top of the gridlines, because the edges are confluent
# with our border and will draw over it, and that looks bad
geom_sf(data = borders, aes(color = ID), lwd = 2) +
scale_color_distiller(palette = "RdBu", guide = "none") +
new_scale_color() +
############ finally we start to add data to the plot.  ##################
# these are the core CCA areas, without the influence of a decoupled population
geom_sf(data = core, aes(color = Group, fill = Group), lwd = 1.1, alpha = 0.3) +
# add the areas where the climate is decoupled within a morphotype
# based seed zone
geom_sf(data = decoupled, aes(color = Group), lwd = 1.1, fill = NA, lty = 1) +
# these are the points representing morphos from a CCA
geom_sf(data = morphos, aes(shape = Status, fill = Group), size = 3) +
scale_shape_manual(values = shapes, name = "Population:")  +
scale_fill_manual(
values = values,
labels = labs,
name = 'STZ Group'
) +
scale_color_manual(
values = values,
labels = labs,
name = 'STZ Group'
) +
# labels for easy orientation
geom_label(aes(x = 20, y = 45, label='Temperature'), size = 5, angle = 60, fill = '#FFFFF0') +
geom_text(aes(x = 8, y = 20, label='warmer'), angle = 60) +
geom_text(aes(x = 36, y = 68, label='cooler'), angle = 60) +
geom_label(aes(x = 80, y = 45, label='Precipitation'),  size = 5, angle = 300, fill = '#FFFFF0') +
geom_text(aes(x = 64, y = 68, label='more'), angle = 300) +
geom_text(aes(x = 92, y = 20, label='less'), angle = 300) +
geom_label(aes(x = 50, y = -5, label='Geomorphology'), size = 5, fill = '#FFFFF0') +
geom_text(aes(x = 23, y = -3, label='drier')) +
geom_text(aes(x = 78, y = -3, label='wetter')) +
# backdrop ellipses for the text boxes.
geom_sf(data = wet_lab_bg, fill = '#124E78', alpha = 0.4, color = '#124E78', lwd = 1.1) +
geom_sf(data = int_lab_bg, fill = '#B5C2B7', alpha = 0.4, color = '#B5C2B7', lwd = 1.1) +
geom_sf(data = dri_lab_bg, fill = '#A40E4C', alpha = 0.4, color = '#A40E4C', lwd = 1.1) +
# text boxes explaining the groups
geom_text(aes(x = 10, y = 80, label = Wettest_label), size = 3) +
geom_text(aes(x = 90, y = 70, label = Intermediate_label), size = 3) +
geom_text(aes(x = 10.25, y = 60, label = Driest_label), size = 3) +
labs(
title = 'Possible effects of climatic decoupling on STZ delineation',
caption = 'Each ellipsoid represents clusters of morphotypes, an STZ group, from a canonical\n correspondence analysis of traits measured in a common garden(s).') +
theme_void() +
xlim(-10, 110) +
theme(
legend.position = 'bottom',
legend.box = "vertical",
plot.title = element_text(hjust = 0.5),
plot.caption = element_text(hjust = 0.5)
) +
guides(
shape = guide_legend(title = "Population:", nrow = 1, order = 1),
color = guide_legend(nrow = 1)
)
ggsave( '../figures/decoupling.png', p, height = 750, width = 750, units = 'px')
p <- ggplot() +
# first draw the raster background, everything else will be superimposed on top
# of it
geom_raster(data = int_bg, aes(x = x, y = y, fill = ID)) +
scale_fill_distiller(palette = "RdBu", guide = "none", direction = 1) +
new_scale_fill() +
# and add this to remove the values from going straight up against the borders
geom_sf(data = bord, color = '#FFFFF0')+
# now we add the grid lines across it, in the style of a USDA soil triangle
geom_sf(data = lines, color = '#FFFFF0') +
# we add the border on top of the gridlines, because the edges are confluent
# with our border and will draw over it, and that looks bad
geom_sf(data = borders, aes(color = ID), lwd = 2) +
scale_color_distiller(palette = "RdBu", guide = "none") +
new_scale_color() +
############ finally we start to add data to the plot.  ##################
# these are the core CCA areas, without the influence of a decoupled population
geom_sf(data = core, aes(color = Group, fill = Group), lwd = 1.1, alpha = 0.3) +
# add the areas where the climate is decoupled within a morphotype
# based seed zone
geom_sf(data = decoupled, aes(color = Group), lwd = 1.1, fill = NA, lty = 1) +
# these are the points representing morphos from a CCA
geom_sf(data = morphos, aes(shape = Status, fill = Group), size = 3) +
scale_shape_manual(values = shapes, name = "Population:")  +
scale_fill_manual(
values = values,
labels = labs,
name = 'STZ Group'
) +
scale_color_manual(
values = values,
labels = labs,
name = 'STZ Group'
) +
# labels for easy orientation
geom_label(aes(x = 20, y = 45, label='Temperature'), size = 5, angle = 60, fill = '#FFFFF0') +
geom_text(aes(x = 8, y = 20, label='warmer'), angle = 60) +
geom_text(aes(x = 36, y = 68, label='cooler'), angle = 60) +
geom_label(aes(x = 80, y = 45, label='Precipitation'),  size = 5, angle = 300, fill = '#FFFFF0') +
geom_text(aes(x = 64, y = 68, label='more'), angle = 300) +
geom_text(aes(x = 92, y = 20, label='less'), angle = 300) +
geom_label(aes(x = 50, y = -5, label='Geomorphology'), size = 5, fill = '#FFFFF0') +
geom_text(aes(x = 23, y = -3, label='drier')) +
geom_text(aes(x = 78, y = -3, label='wetter')) +
# backdrop ellipses for the text boxes.
geom_sf(data = wet_lab_bg, fill = '#124E78', alpha = 0.4, color = '#124E78', lwd = 1.1) +
geom_sf(data = int_lab_bg, fill = '#B5C2B7', alpha = 0.4, color = '#B5C2B7', lwd = 1.1) +
geom_sf(data = dri_lab_bg, fill = '#A40E4C', alpha = 0.4, color = '#A40E4C', lwd = 1.1) +
# text boxes explaining the groups
geom_text(aes(x = 10, y = 80, label = Wettest_label), size = 3) +
geom_text(aes(x = 90, y = 70, label = Intermediate_label), size = 3) +
geom_text(aes(x = 10.25, y = 60, label = Driest_label), size = 3) +
labs(
title = 'Possible effects of climatic decoupling on STZ delineation',
caption = 'Each ellipsoid represents clusters of morphotypes, an STZ group, from a canonical\n correspondence analysis of traits measured in a common garden(s).') +
theme_void() +
xlim(-10, 110) +
theme(
legend.position = 'bottom',
legend.box = "vertical",
plot.title = element_text(hjust = 0.5),
plot.caption = element_text(hjust = 0.5)
) +
guides(
shape = guide_legend(title = "Population:", nrow = 1, order = 1),
color = guide_legend(nrow = 1)
)
ggsave( '../figures/decoupling.png', p, height = 750, width = 750, units = 'px')
ggsave( '../figures/decoupling.png', p, height = 1500, width = 1500, units = 'px')
ggsave( '../figures/decoupling.png', p, height = 2500, width = 2500, units = 'px')
ggsave( '../figures/decoupling.png', p, height = 2100, width = 2100, units = 'px')
bord <- st_buffer(triangle, -0.7) |>
sf::st_cast('MULTILINESTRING')
p <- ggplot() +
# first draw the raster background, everything else will be superimposed on top
# of it
geom_raster(data = int_bg, aes(x = x, y = y, fill = ID)) +
scale_fill_distiller(palette = "RdBu", guide = "none", direction = 1) +
new_scale_fill() +
# and add this to remove the values from going straight up against the borders
geom_sf(data = bord, color = '#FFFFF0')+
# now we add the grid lines across it, in the style of a USDA soil triangle
geom_sf(data = lines, color = '#FFFFF0') +
# we add the border on top of the gridlines, because the edges are confluent
# with our border and will draw over it, and that looks bad
geom_sf(data = borders, aes(color = ID), lwd = 2) +
scale_color_distiller(palette = "RdBu", guide = "none") +
new_scale_color() +
############ finally we start to add data to the plot.  ##################
# these are the core CCA areas, without the influence of a decoupled population
geom_sf(data = core, aes(color = Group, fill = Group), lwd = 1.1, alpha = 0.3) +
# add the areas where the climate is decoupled within a morphotype
# based seed zone
geom_sf(data = decoupled, aes(color = Group), lwd = 1.1, fill = NA, lty = 1) +
# these are the points representing morphos from a CCA
geom_sf(data = morphos, aes(shape = Status, fill = Group), size = 3) +
scale_shape_manual(values = shapes, name = "Population:")  +
scale_fill_manual(
values = values,
labels = labs,
name = 'STZ Group'
) +
scale_color_manual(
values = values,
labels = labs,
name = 'STZ Group'
) +
# labels for easy orientation
geom_label(aes(x = 20, y = 45, label='Temperature'), size = 5, angle = 60, fill = '#FFFFF0') +
geom_text(aes(x = 8, y = 20, label='warmer'), angle = 60) +
geom_text(aes(x = 36, y = 68, label='cooler'), angle = 60) +
geom_label(aes(x = 80, y = 45, label='Precipitation'),  size = 5, angle = 300, fill = '#FFFFF0') +
geom_text(aes(x = 64, y = 68, label='more'), angle = 300) +
geom_text(aes(x = 92, y = 20, label='less'), angle = 300) +
geom_label(aes(x = 50, y = -5, label='Geomorphology'), size = 5, fill = '#FFFFF0') +
geom_text(aes(x = 23, y = -3, label='drier')) +
geom_text(aes(x = 78, y = -3, label='wetter')) +
# backdrop ellipses for the text boxes.
geom_sf(data = wet_lab_bg, fill = '#124E78', alpha = 0.4, color = '#124E78', lwd = 1.1) +
geom_sf(data = int_lab_bg, fill = '#B5C2B7', alpha = 0.4, color = '#B5C2B7', lwd = 1.1) +
geom_sf(data = dri_lab_bg, fill = '#A40E4C', alpha = 0.4, color = '#A40E4C', lwd = 1.1) +
# text boxes explaining the groups
geom_text(aes(x = 10, y = 80, label = Wettest_label), size = 3) +
geom_text(aes(x = 90, y = 70, label = Intermediate_label), size = 3) +
geom_text(aes(x = 10.25, y = 60, label = Driest_label), size = 3) +
labs(
title = 'Possible effects of climatic decoupling on STZ delineation',
caption = 'Each ellipsoid represents clusters of morphotypes, an STZ group, from a canonical\n correspondence analysis of traits measured in a common garden(s).') +
theme_void() +
xlim(-10, 110) +
theme(
legend.position = 'bottom',
legend.box = "vertical",
plot.title = element_text(hjust = 0.5),
plot.caption = element_text(hjust = 0.5)
) +
guides(
shape = guide_legend(title = "Population:", nrow = 1, order = 1),
color = guide_legend(nrow = 1)
)
ggsave( '../figures/decoupling.png', p, height = 2100, width = 2100, units = 'px')
p <- ggplot() +
# first draw the raster background, everything else will be superimposed on top
# of it
geom_raster(data = int_bg, aes(x = x, y = y, fill = ID)) +
scale_fill_distiller(palette = "RdBu", guide = "none", direction = 1) +
new_scale_fill() +
# and add this to remove the values from going straight up against the borders
# geom_sf(data = bord, color = '#FFFFF0')+
# now we add the grid lines across it, in the style of a USDA soil triangle
geom_sf(data = lines, color = '#FFFFF0') +
# we add the border on top of the gridlines, because the edges are confluent
# with our border and will draw over it, and that looks bad
geom_sf(data = borders, aes(color = ID), lwd = 2) +
scale_color_distiller(palette = "RdBu", guide = "none") +
new_scale_color() +
############ finally we start to add data to the plot.  ##################
# these are the core CCA areas, without the influence of a decoupled population
geom_sf(data = core, aes(color = Group, fill = Group), lwd = 1.1, alpha = 0.3) +
# add the areas where the climate is decoupled within a morphotype
# based seed zone
geom_sf(data = decoupled, aes(color = Group), lwd = 1.1, fill = NA, lty = 1) +
# these are the points representing morphos from a CCA
geom_sf(data = morphos, aes(shape = Status, fill = Group), size = 3) +
scale_shape_manual(values = shapes, name = "Population:")  +
scale_fill_manual(
values = values,
labels = labs,
name = 'STZ Group'
) +
scale_color_manual(
values = values,
labels = labs,
name = 'STZ Group'
) +
# labels for easy orientation
geom_label(aes(x = 20, y = 45, label='Temperature'), size = 5, angle = 60, fill = '#FFFFF0') +
geom_text(aes(x = 8, y = 20, label='warmer'), angle = 60) +
geom_text(aes(x = 36, y = 68, label='cooler'), angle = 60) +
geom_label(aes(x = 80, y = 45, label='Precipitation'),  size = 5, angle = 300, fill = '#FFFFF0') +
geom_text(aes(x = 64, y = 68, label='more'), angle = 300) +
geom_text(aes(x = 92, y = 20, label='less'), angle = 300) +
geom_label(aes(x = 50, y = -5, label='Geomorphology'), size = 5, fill = '#FFFFF0') +
geom_text(aes(x = 23, y = -3, label='drier')) +
geom_text(aes(x = 78, y = -3, label='wetter')) +
# backdrop ellipses for the text boxes.
geom_sf(data = wet_lab_bg, fill = '#124E78', alpha = 0.4, color = '#124E78', lwd = 1.1) +
geom_sf(data = int_lab_bg, fill = '#B5C2B7', alpha = 0.4, color = '#B5C2B7', lwd = 1.1) +
geom_sf(data = dri_lab_bg, fill = '#A40E4C', alpha = 0.4, color = '#A40E4C', lwd = 1.1) +
# text boxes explaining the groups
geom_text(aes(x = 10, y = 80, label = Wettest_label), size = 3) +
geom_text(aes(x = 90, y = 70, label = Intermediate_label), size = 3) +
geom_text(aes(x = 10.25, y = 60, label = Driest_label), size = 3) +
labs(
title = 'Possible effects of climatic decoupling on STZ delineation',
caption = 'Each ellipsoid represents clusters of morphotypes, an STZ group, from a canonical\n correspondence analysis of traits measured in a common garden(s).') +
theme_void() +
xlim(-10, 110) +
theme(
legend.position = 'bottom',
legend.box = "vertical",
plot.title = element_text(hjust = 0.5),
plot.caption = element_text(hjust = 0.5)
) +
guides(
shape = guide_legend(title = "Population:", nrow = 1, order = 1),
color = guide_legend(nrow = 1)
)
ggsave( '../figures/decoupling.png', p, height = 2100, width = 2100, units = 'px')
p <- ggplot() +
# first draw the raster background, everything else will be superimposed on top
# of it
geom_raster(data = int_bg, aes(x = x, y = y, fill = ID)) +
scale_fill_distiller(palette = "RdBu", guide = "none", direction = 1) +
new_scale_fill() +
# and add this to remove the values from going straight up against the borders
geom_sf(data = bord, color = '#FFFFF0')+
# now we add the grid lines across it, in the style of a USDA soil triangle
geom_sf(data = lines, color = '#FFFFF0') +
# we add the border on top of the gridlines, because the edges are confluent
# with our border and will draw over it, and that looks bad
geom_sf(data = borders, aes(color = ID), lwd = 2) +
scale_color_distiller(palette = "RdBu", guide = "none") +
new_scale_color() +
############ finally we start to add data to the plot.  ##################
# these are the core CCA areas, without the influence of a decoupled population
geom_sf(data = core, aes(color = Group, fill = Group), lwd = 1.1, alpha = 0.3) +
# add the areas where the climate is decoupled within a morphotype
# based seed zone
geom_sf(data = decoupled, aes(color = Group), lwd = 1.1, fill = NA, lty = 1) +
# these are the points representing morphos from a CCA
geom_sf(data = morphos, aes(shape = Status, fill = Group), size = 3) +
scale_shape_manual(values = shapes, name = "Population:")  +
scale_fill_manual(
values = values,
labels = labs,
name = 'STZ Group'
) +
scale_color_manual(
values = values,
labels = labs,
name = 'STZ Group'
) +
# labels for easy orientation
geom_label(aes(x = 20, y = 45, label='Temperature'), size = 5, angle = 60, fill = '#FFFFF0') +
geom_text(aes(x = 8, y = 20, label='warmer'), angle = 60) +
geom_text(aes(x = 36, y = 68, label='cooler'), angle = 60) +
geom_label(aes(x = 80, y = 45, label='Precipitation'),  size = 5, angle = 300, fill = '#FFFFF0') +
geom_text(aes(x = 64, y = 68, label='more'), angle = 300) +
geom_text(aes(x = 92, y = 20, label='less'), angle = 300) +
geom_label(aes(x = 50, y = -5, label='Geomorphology'), size = 5, fill = '#FFFFF0') +
geom_text(aes(x = 23, y = -3, label='drier')) +
geom_text(aes(x = 78, y = -3, label='wetter')) +
# backdrop ellipses for the text boxes.
geom_sf(data = wet_lab_bg, fill = '#124E78', alpha = 0.4, color = '#124E78', lwd = 1.1) +
geom_sf(data = int_lab_bg, fill = '#B5C2B7', alpha = 0.4, color = '#B5C2B7', lwd = 1.1) +
geom_sf(data = dri_lab_bg, fill = '#A40E4C', alpha = 0.4, color = '#A40E4C', lwd = 1.1) +
# text boxes explaining the groups
geom_text(aes(x = 10, y = 80, label = Wettest_label), size = 3) +
geom_text(aes(x = 90, y = 70, label = Intermediate_label), size = 3) +
geom_text(aes(x = 10.25, y = 60, label = Driest_label), size = 3) +
labs(
title = 'Possible effects of climatic decoupling on STZ delineation',
caption = 'Each ellipsoid represents clusters of morphotypes, an STZ group, from a canonical\n correspondence analysis of traits measured in a common garden(s).') +
theme_void() +
xlim(-10, 110) +
theme(
legend.position = 'bottom',
legend.box = "vertical",
plot.title = element_text(hjust = 0.5),
plot.caption = element_text(hjust = 0.5)
) +
guides(
shape = guide_legend(title = "Population:", nrow = 1, order = 1),
color = guide_legend(nrow = 1)
)
ggsave( '../figures/decoupling.png', p, height = 2100, width = 2100, units = 'px')
bord <- st_buffer(triangle, -0.5) |>
sf::st_cast('MULTILINESTRING')
p <- ggplot() +
# first draw the raster background, everything else will be superimposed on top
# of it
geom_raster(data = int_bg, aes(x = x, y = y, fill = ID)) +
scale_fill_distiller(palette = "RdBu", guide = "none", direction = 1) +
new_scale_fill() +
# and add this to remove the values from going straight up against the borders
geom_sf(data = bord, color = '#FFFFF0')+
# now we add the grid lines across it, in the style of a USDA soil triangle
geom_sf(data = lines, color = '#FFFFF0') +
# we add the border on top of the gridlines, because the edges are confluent
# with our border and will draw over it, and that looks bad
geom_sf(data = borders, aes(color = ID), lwd = 2) +
scale_color_distiller(palette = "RdBu", guide = "none") +
new_scale_color() +
############ finally we start to add data to the plot.  ##################
# these are the core CCA areas, without the influence of a decoupled population
geom_sf(data = core, aes(color = Group, fill = Group), lwd = 1.1, alpha = 0.3) +
# add the areas where the climate is decoupled within a morphotype
# based seed zone
geom_sf(data = decoupled, aes(color = Group), lwd = 1.1, fill = NA, lty = 1) +
# these are the points representing morphos from a CCA
geom_sf(data = morphos, aes(shape = Status, fill = Group), size = 3) +
scale_shape_manual(values = shapes, name = "Population:")  +
scale_fill_manual(
values = values,
labels = labs,
name = 'STZ Group'
) +
scale_color_manual(
values = values,
labels = labs,
name = 'STZ Group'
) +
# labels for easy orientation
geom_label(aes(x = 20, y = 45, label='Temperature'), size = 5, angle = 60, fill = '#FFFFF0') +
geom_text(aes(x = 8, y = 20, label='warmer'), angle = 60) +
geom_text(aes(x = 36, y = 68, label='cooler'), angle = 60) +
geom_label(aes(x = 80, y = 45, label='Precipitation'),  size = 5, angle = 300, fill = '#FFFFF0') +
geom_text(aes(x = 64, y = 68, label='more'), angle = 300) +
geom_text(aes(x = 92, y = 20, label='less'), angle = 300) +
geom_label(aes(x = 50, y = -5, label='Geomorphology'), size = 5, fill = '#FFFFF0') +
geom_text(aes(x = 23, y = -3, label='drier')) +
geom_text(aes(x = 78, y = -3, label='wetter')) +
# backdrop ellipses for the text boxes.
geom_sf(data = wet_lab_bg, fill = '#124E78', alpha = 0.4, color = '#124E78', lwd = 1.1) +
geom_sf(data = int_lab_bg, fill = '#B5C2B7', alpha = 0.4, color = '#B5C2B7', lwd = 1.1) +
geom_sf(data = dri_lab_bg, fill = '#A40E4C', alpha = 0.4, color = '#A40E4C', lwd = 1.1) +
# text boxes explaining the groups
geom_text(aes(x = 10, y = 80, label = Wettest_label), size = 3) +
geom_text(aes(x = 90, y = 70, label = Intermediate_label), size = 3) +
geom_text(aes(x = 10.25, y = 60, label = Driest_label), size = 3) +
labs(
title = 'Possible effects of climatic decoupling on STZ delineation',
caption = 'Each ellipsoid represents clusters of morphotypes, an STZ group, from a canonical\n correspondence analysis of traits measured in a common garden(s).') +
theme_void() +
xlim(-10, 110) +
theme(
legend.position = 'bottom',
legend.box = "vertical",
plot.title = element_text(hjust = 0.5),
plot.caption = element_text(hjust = 0.5)
) +
guides(
shape = guide_legend(title = "Population:", nrow = 1, order = 1),
color = guide_legend(nrow = 1)
)
ggsave( '../figures/decoupling.png', p, height = 2100, width = 2100, units = 'px')
ggsave( '../figures/decoupling.png', p, height = 2250, width = 2250, units = 'px')
